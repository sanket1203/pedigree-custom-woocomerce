jQuery(document).ready(function(e){var a,i,o={message:null,overlayCSS:{background:"#000",opacity:.6},ignoreIfBlocked:!0},d=function(){var a=e("#ywcfav_video_add_by"),i=e(".ywfav_add_video");e(".ywcfav_delete");a.on("change",function(a){var i=e(this),o=i.val(),d=i.parents("#ywcfav_form_container"),t=d.find(".video_add_by_id"),r=d.find(".video_add_by_url"),n=d.find(".video_add_by_embedded"),_=d.find(".video_add_by_upload"),c=d.find(".video_type_host"),v=d.find(".video_name"),l=d.find(".ywfav_add_video");switch(i.hasClass("error_field")&&i.removeClass("error_field"),v.show(),o){case"id":t.show(),r.hide(),n.hide(),_.hide(),c.show(),l.show();break;case"url":t.hide(),r.show(),n.hide(),_.hide(),c.show(),l.show();break;case"embd":t.hide(),r.hide(),n.show(),_.hide(),c.hide(),l.show();break;case"upload":t.hide(),r.hide(),n.hide(),_.show(),c.hide(),l.hide();break;default:t.hide(),r.hide(),n.hide(),_.hide(),c.hide(),v.hide(),l.hide()}}),i.on("click",function(i){var d=a.val(),n="",c="",v=!1,l=e("#ywcfav_video_name"),f=l.val();if(""==d)return a.addClass("error_field"),void i.preventDefault();if(""==f)return l.addClass("error_field"),void i.preventDefault();switch(d){case"id":n=e("#ywcfav_video_add_by_id"),c=n.val(),""==c&&(v=!0);break;case"url":n=e("#ywcfav_video_add_by_url"),c=n.val(),""==c&&(v=!0);break;case"embd":n=e("#ywcfav_video_add_by_embedded"),c=n.val(),""==c&&(v=!0);break;case"upload":n=e("#ywcfav_video_id_up"),c=n.val(),""==c&&(v=!0)}if(v)n.parent().addClass("error_field"),i.preventDefault();else{var s=ywcfav.video_placeholder_img_id,u=e("#ywcfav_video_data");if(u.block(o),"upload"==d)_(d,"host",s,f,c),setTimeout(function(){u.unblock()},500);else if("embd"==d)_(d,"embedded",s,f,encodeURI(c)),setTimeout(function(){u.unblock()},500);else{var w=e("#ywcfav_video_type_host").val(),y="";switch(d){case"id":y=c;break;case"url":y="vimeo"==w?r(c):t(c)}var m={ywcfav_id:y,ywcfav_host:w,ywcfav_name:f,action:ywcfav.actions.save_thumbnail_video};e.ajax({type:"POST",url:ywcfav.admin_url,data:m,dataType:"json",success:function(e){s="ok"==e.result?e.id_img:ywcfav.video_placeholder_img_id,_(d,w,s,f,encodeURI(c)),u.unblock()}})}e("body").trigger("ywcfav_row_insert")}}),e(document).on("click",".ywcfav_delete",function(a){a.preventDefault();var i=e(this),o=i.parent().parent(),d=o.find(".ywcfav_video_id").val();o.remove(),e("body").trigger("ywcfav_remove_content",[d])})},t=function(e){var a,i=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,o=e.match(i);return a=o&&11===o[2].length?o[2]:null},r=function(e){var a,i=/^.*(vimeo\.com\/)((channels\/[A-z]+\/)|(groups\/[A-z]+\/videos\/))?([0-9]+)/,o=e.match(i);return o&&(a=o[5]),a},n=function(){return"id-"+Math.random().toString(36).substr(2,16)},_=function(a,i,o,d,t){var r=e(".product_video .ywcfav_woocommerce_video"),_="ywcfav_video_"+n(),c=r.size(),v={video_type:a,video_name:d,video_content:t,video_img:o,video_id:_,video_host:i,product_id:woocommerce_admin_meta_boxes.post_id,loop:c,action:ywcfav.actions.add_new_video_row};e.ajax({type:"POST",url:ywcfav.admin_url,data:v,dataType:"json",success:function(a){e(".product_video").append(a.result),e("body").trigger("ywcfav_new_content_insert",[_,d]),e("body").trigger("ywcfav_featured_insert")}})};e(document).on("ywcfav_row_insert",function(a){e("#ywcfav_video_add_by").val("").change(),e("#ywcfav_video_add_by_id").val(""),e("#ywcfav_video_add_by_url").val(""),e("#ywcfav_video_add_by_embedded").val(""),e("#ywcfav_video_name").val(""),e("#ywcfav_video_url_up").val(""),e("#ywcfav_video_id_up").val("")}),e(document).on("ywcfav_featured_insert",function(a){e("input").removeClass("error_field"),e("select").removeClass("error_field"),e("textarea").removeClass("erorr_field")}),e(document).on("ywcfav_new_content_insert",function(a,i,d){var t=e(".ywcfav_select_featured_content"),r=e(".select_featured");t.block(o),r.append('<option value="'+i+'">'+d+"</option>"),setTimeout(function(){t.unblock()},500)}),e(document).on("ywcfav_remove_content",function(a,i){var d=e(".ywcfav_select_featured_content"),t=e(".select_featured");d.block(o),t.find('option[value="'+i+'"]').remove(),setTimeout(function(){d.unblock()},500)}),e("#ywcfav_video_add_by_upload").on("click",function(i){var o=e(this),d=e(".ywfav_add_video");if(i.preventDefault(),a)return void a.open();var t=[new wp.media.controller.Library({library:wp.media.query({type:"video"}),multiple:!1,title:o.data("choose"),priority:20,filterable:"uploaded"})];a=wp.media.frames.downloadable_file=wp.media({title:o.data("choose"),library:{type:"video"},button:{text:o.data("choose")},multiple:!1,states:t}),a.on("select",function(){var i="",o="",t=a.state().get("selection");t.map(function(e){return e=e.toJSON(),"video"!=e.type?void alert(ywcfav.error_video):void(e.url&&(i=e.url,o=e.id))});var r=e(document).find("#ywcfav_video_url_up"),n=e(document).find("#ywcfav_video_id_up");n.val(o),r.val(i),d.click()}),a.open()}),e(document).on("click",".ywcfav_upload_image_button",function(a){var o=e(this);a.preventDefault();var d=[new wp.media.controller.Library({library:wp.media.query({type:"image"}),multiple:!1,title:o.data("choose"),priority:20,filterable:"all"})];i=wp.media.frames.downloadable_file=wp.media({title:o.data("choose"),library:{type:"image"},button:{text:o.data("choose")},multiple:!1,states:d}),i.on("select",function(){var e="",a="",d=i.state().get("selection");d.map(function(i){if(i=i.toJSON(),i.url){e=i.url,a=i.id;var d=o.parent().parent().find(".ywcfav_thumbn_error"),t=d.find(".ywcfav_thumbn_error_container"),r=parseInt(i.width);if(t.hide(),r<ywcfav.min_width)if(t.length)t.show();else{var n='<div class="ywcfav_thumbn_error_container"><div class="ywcfav_icon_error">&nbsp;'+ywcfav.error_txt+'</div><div class="ywcfav_txt_error">'+ywcfav.error_full_txt+"</div></div>";d.html(n)}o.parent().find(".thumbn_id").val(a),o.find(".ywcfav_thumbn").attr("src",e)}})}),i.open()});var c=function(){e(".ywcfav_insert_track").on("click",function(){var a=e("#ywcfav_audio_data"),i=e("#ywcfav_audio_name"),d=e("#ywcfav_audio_url"),t=i.val(),r=d.val(),_=!1;if(""==t&&(i.addClass("error_field"),_=!0),""==r&&(d.addClass("error_field"),_=!0),!_){a.block(o);var c=e(".product_audio .ywcfav_woocommerce_audio_data"),v="ywcfav_audio_"+n(),l=c.size(),f={audio_name:t,audio_content:encodeURI(r),audio_img:ywcfav.audio_placeholder_img_id,audio_id:v,product_id:woocommerce_admin_meta_boxes.post_id,loop:l,action:ywcfav.actions.add_new_audio_row};e.ajax({type:"POST",url:ywcfav.admin_url,data:f,dataType:"json",success:function(o){e(".product_audio").append(o.result),a.unblock(),i.val(""),d.val(""),e("body").trigger("ywcfav_new_content_insert",[v,t]),e("body").trigger("ywcfav_featured_insert")}})}}),e(document).on("click",".ywcfav_delete_audio",function(a){a.preventDefault();var i=e(this),o=i.parent().parent(),d=o.find(".ywcfav_audio_id").val();o.remove(),e("body").trigger("ywcfav_remove_content",[d])})},v=function(a,i,o,d,t,r){var _=a.find(".ywcfav_variable_video_container"),c=_.data("loop"),v=a.find('input:hidden[name^="variable_post_id"]').val(),l={video_id:"ywcfav_video_"+n(),video_type:i,video_name:t,video_content:r,video_host:o,video_img:d,product_id:v,loop:c,action:ywcfav.actions.add_new_video_variation};e.ajax({type:"POST",url:ywcfav.admin_url,data:l,dataType:"json",success:function(i){_.html(i.result),a.find(".ywcfav_variable_video_add_container").hide(),e("body").trigger("ywcfav_featured_insert")}})};e(document).on("woocommerce_variations_loaded woocommerce_variations_added",function(){e(document).on("change",".ywcfav_variation_video_add_by",function(a){var i=e(this),o=i.val(),d=e(this).closest(".woocommerce_variation").find(".ywcfav_variable_video"),t=d.find(".variation_video_add_by_id"),r=d.find(".variation_video_add_by_url"),n=d.find(".variation_video_add_by_embedded"),_=d.find(".variation_video_add_by_upload"),c=d.find(".variation_video_type"),v=d.find(".variation_video_title"),l=d.find(".variation_video_button_add");switch(i.hasClass("error_field")&&i.removeClass("error_field"),o){case"id":v.show(),t.show(),r.hide(),n.hide(),_.hide(),c.show(),l.show();break;case"url":v.show(),t.hide(),r.show(),n.hide(),_.hide(),c.show(),l.show();break;case"embd":v.show(),t.hide(),r.hide(),n.show(),_.hide(),c.hide(),l.show();break;case"upload":v.show(),t.hide(),r.hide(),n.hide(),_.show(),c.hide(),l.hide();break;default:v.hide(),t.hide(),r.hide(),n.hide(),_.hide(),c.hide(),l.hide()}}),e(document).on("click",".ywcfav_add_variable_video",function(a){var i=e(this),d=i.closest(".woocommerce_variation"),n=d.find(".ywcfav_variation_video_add_by").val(),_="",c="",l=d.find(".ywcfav_variation_video_title"),f=l.val(),s=!1;switch(""==f&&(s=!0,l.addClass("error_field")),n){case"id":_=d.find(".ywcfav_variation_video_add_by_id"),c=_.val(),""==c&&(s=!0);break;case"url":_=d.find(".ywcfav_variation_video_add_by_url"),c=_.val(),""==c&&(s=!0);break;case"embd":_=d.find(".ywcfav_variation_video_add_by_embedded"),c=_.val(),""==c&&(s=!0);break;case"upload":_=d.find(".ywcfav_variation_video_id"),c=_.val(),""==c&&(s=!0)}if(s)_.parent().addClass("error_field"),a.preventDefault();else{var u=ywcfav.video_placeholder_img_id;if(d.block(o),"upload"==n)v(d,n,"host",u,f,c),setTimeout(function(){d.unblock()},500);else if("embd"==n)v(d,n,"embedded",u,f,encodeURI(c)),setTimeout(function(){d.unblock()},500);else{var w=d.find(".ywcfav_variation_video_type_host").val(),y="";switch(n){case"id":y=c;break;case"url":y="vimeo"==w?r(c):t(c)}var m={ywcfav_id:y,ywcfav_host:w,ywcfav_name:f,action:ywcfav.actions.save_thumbnail_video};e.ajax({type:"POST",url:ywcfav.admin_url,data:m,dataType:"json",success:function(e){u="ok"==e.result?e.id_img:ywcfav.video_placeholder_img_id,v(d,n,w,u,f,encodeURI(c)),d.unblock(),d.addClass("variation-needs-update")}})}}}),e(document).on("click",".remove_video",function(a){var i=e(this),d=i.closest(".woocommerce_variation"),t=d.find(".ywcfav_variable_video_container"),r=d.find(".ywcfav_variable_video_add_container");d.block(o),setTimeout(function(){t.html(""),d.unblock(),d.addClass("variation-needs-update"),r.find("input").val(""),r.find("select").val(""),r.show()},500)}),e(document).on("click",".ywcfav_variation_upload_image_button",function(a){var o=e(this);a.preventDefault();var d=[new wp.media.controller.Library({library:wp.media.query({type:"image"}),multiple:!1,title:o.data("choose"),priority:20,filterable:"all"})];i=wp.media.frames.downloadable_file=wp.media({title:o.data("choose"),library:{type:"image"},button:{text:o.data("choose")},multiple:!1,states:d}),i.on("select",function(){var e="",a="",d=i.state().get("selection");d.map(function(i){if(i=i.toJSON(),i.url){e=i.url,a=i.id;var d=o.parent().parent().find(".ywcfav_thumbn_error"),t=d.find(".ywcfav_thumbn_error_container"),r=parseInt(i.width);if(t.hide(),r<ywcfav.min_width)if(t.length)t.show();else{var n='<div class="ywcfav_thumbn_error_container"><div class="ywcfav_icon_error">&nbsp;'+ywcfav.error_txt+'</div><div class="ywcfav_txt_error">'+ywcfav.error_full_txt+"</div></div>";d.html(n)}o.closest(".woocommerce_variation").find(".thumbn_id").val(a),o.closest(".woocommerce_variation").find(".ywcfav_variation_thumbn").attr("src",e),o.closest(".woocommerce_variation").addClass("variation-needs-update")}})}),i.open()}),e(document).on("click",".ywcfav_variation_video_add_by_upload",function(i){var o=e(this),d=o.closest(".woocommerce_variation").find(".variation_video_add_by_upload"),t=d.find(".ywcfav_variation_video_id"),r=o.closest(".woocommerce_variation").find(".ywcfav_add_variable_video");if(i.preventDefault(),a)return void a.open();var n=[new wp.media.controller.Library({library:wp.media.query({type:"video"}),multiple:!1,title:o.data("choose"),priority:20,filterable:"uploaded"})];a=wp.media.frames.downloadable_file=wp.media({title:o.data("choose"),library:{type:"video"},button:{text:o.data("choose")},multiple:!1,states:n}),a.on("select",function(){var e="",i=a.state().get("selection");i.map(function(a){return a=a.toJSON(),"video"!=a.type?void alert(ywcfav.error_video):void(a.id&&(e=a.id))}),t.val(e),r.click()}),a.open()})}),e("#ywcfav_player_type_style").on("change",function(){var a=e(this).val(),i=e("#ywcfav_main_font_colors").parents("tr"),o=e("#ywcfav_control_bg_color").parents("tr"),d=e("#ywcfav_control_bg_color_alpha").parents("tr"),t=e("#ywcfav_slider_color").parents("tr"),r=e("#ywcfav_slider_bg_color").parents("tr"),n=e("#ywcfav_slider_bg_color_alpha").parents("tr"),_=e("#ywcfav_big_play_border_color").parents("tr");"default"==a?(i.hide(),o.hide(),d.hide(),t.hide(),r.hide(),n.hide(),_.hide()):(i.show(),o.show(),d.show(),t.show(),r.show(),n.show(),_.show())}).change(),e("body").on("ywcfav_admin_field_init",function(){d(),c()}).trigger("ywcfav_admin_field_init")});